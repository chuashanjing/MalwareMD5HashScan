import requests
import json

API_KEY = '<API_KEY>'
VT_URL = 'https://www.virustotal.com/api/v3/files'

def scan_md5_hashes(md5_hashes):
    headers = {

        'x-apikey': API_KEY

    }

    for md5_hash in md5_hashes:
        response = requests.get(f"{VT_URL}/{md5_hash}", headers=headers)
        
        if response.status_code == 200:
            try:
                result = response.json()
                print(f"Hash: {md5_hash}")
                
                attributes = result.get('data', {}).get('attributes', {})
                last_analysis_stats = attributes.get('last_analysis_stats', {})

                malicious_count = last_analysis_stats.get('malicious', 0)

                if malicious_count > 0:
                    print("Status: Malicious")
                else:
                    print("Status: Not malicious")

            except json.JSONDecodeError as e:
                print(f"Error decoding JSON response: {e}")
        else:
            print(f"Failed to scan hash: {md5_hash}. Status code: {response.status_code}")

if __name__ == "__main__":

    md5_hashes = [
        '43E3E6F2ADE858D4DF8C06CA95FE7130',
        'C24EE1FF4117C3F8C541E0CCA00E0C94',
        '92251F2DFE14EBABEB19D8E759EF80BD',
        '47FFAC249170EE50F6C3C35764D04BC5',
        'ABE5B1399BD44E96879EB8A57CA9FB59',
        '4FFE9F113339FD4DA2C0AFA45B4001AB',
        '11CE57CA14E3DECE5A90A1268158BA9F',
        '22EEA0A43F64CA6778F7998CEDFEB6BF',
        'DA74B6844EEDE885646CEB294D0881A8',
        'A0AE526481DE478C48D1AD7553FAC8B0',
        '038BED7CE6B4EA50338F36467D216AEF',
        'A68DDDAEC99516BE973C4D612361FAB1',
        '7CE226DDE7656FF1C1DED9BDE7389884',
        '6F94CBCA41AEA696F6F91002F4FC6C6F',
        '9E8F80E55FC4222D0FA37D5ED7933063',
        'B68A0E5A62091EDF8322B193B5101B4A',
        '5ED90BDFA824724EF42DB1B4137EAF85',
        'CA1508457A323E56E24D2115E26064C9',
        'CCCDB6845BEA895AAE0A898C4C9523F7',
        '78C3C39F5162E83DDA947303052AF1EF',
        '1F784578B55AB7EA7CE0C69B5DBA5BDA',
        '92C4FB99D9077796826392CCE0B416B8',
        '833CF026192271E8B5E72CCACFE1D406',
        'F8B03CAA745C21508A6A8E448BD73461',
        'C281A508E9E84E3EFF251BDC8E93B8BA',
        'C04B684EC07E879C43116C57AFDBBF22',
        '63FBC61FF54967340D4673D9DE914CC3',
        '19392797BAC0503F6E5C7E03DAA66FD7',
        '1034F1F3E3C684A54D216CA0189F5AE4',
        '5FD774A5CA21532526C8FF289B00B122',
        '10190374748A3FA707DABA2132F312BA',
        'DA09513D7FB95C7F9F6C13278BBBF958',
        'C6BBEAFFB9766F6C316BD99095764628',
        '07EF0AEDA3227F5101FA2040CEDFC76D',
        'EB0C43BD35738A9B658D4EA5D79B0E2D',
        '6DD416FD56DBAB49684B1CF78FA72D8E',
        'DCB1AAE891B69F1B530CB64CAB5CDBE5',
        '7D7B16ECA9DEE0613BACED8BD5484063',
        '3D54F1D94EB1EC184F928E301590FD82',
        '8AFB2E879F7B6345E5395A0EA7267D70',
        '9438A0A8834F7574AAC9F71C2E44CE77',
        'A9FED5A6D5D78AA7D5E9376712C4CB95',
        '4F8395DBA91A35EDA5939DD197935CDC',
        'D48CE372C24044851A6A34C932FF5640',
        '43E83A22FD07D54D39225CB8D1B7842F',
        '5317B2DA8EC9D404B252B5C157A3C7CF',
        'A024677B65B2E173CE049D59721029BE',
        '1A62A8AD2E496EE8BD2578328205E40F',
        '03AF1DE5DF75BAFB4CC21C8A864C2581',
        '5E3CB931457F356EDF3CB2726EA91036',
        '498B45580F1BB0E497FE1E5EC4B4084E',
        'E4308C42EAC8F39C9245973717AEB5FE',
        '74578A5F621CC9EFF83F9C938AFBDABD',
        '3DB89B56147D221594D061320C777351',
        '4DE325BFDF3F4C0A75DCE0F1FB58A7BD',
        '32EDFA0E03BF318473045A640616CEFA',
        '8B35A32C07B379D3A1C4802ED3DEDF23',
        'D4091BD24345012FB272E82E2E73C9DF',
        'D4091BD24345012FB272E82E2E73C9DF',
        '285CF3FE937C627358C0BB97980ABB7B',
        'A6238FA9B91BA0971E7BB3EA35E5C5C3',
        'C3A21110548962655D2A17D94AC9DCA2',
        'C783712D2F467F92B7ABAE4BF3553D00',
        'EDE4FAC1D9D6D887FE670CE1B21A5E3B',
        'DC9345EE557FF54873F890FB5C19A085',
        'B609A449709BAE8F264667BCBAA62A64',
        '92A2DE6428A1108E5AB72E0079F86A88',
        '2E83FF09960657EA2CA422B8300DF081',
        '67E2D8166083326FDD339B838858DE44',
        'BDA2BBC72AD11DDEAFA938534D91A865',
        'FAC29C292376D0422C5B75E1D47638D1',
        'D7184543028C41BEFED65D5CAE53DA2B',
        '7BAE55D698B0E252021CD1B48823B84C',
        '532D40C96C2F2B94E08C5AEB1307C54D',
        'E9DE6BF0D3E7F6AC6C7AE4051501773E',
        'BDE92BDC84C89E059FFAD05C864ED1C5',
        '5F5AF8872CA9B21593385B6E1D092A6B',
        '800285A3E693F88EC8CE88DCEEA5F122',
        '4BBC25AF85368EBFD74AC541A62B2E8D',
        '8895E59FF9D7D779022E8D789658EEE8',
        '8094630CA2F0847CFAE90DEBE405ADD7',
        'DD35F931B1671B6531CBC0F078DE269B',
        'D97BEF180744675A1B94C1E73380D961',
        'BF04E2FF00F6977DB5FB30D048F1D661',
        'BF04E2FF00F6977DB5FB30D048F1D661',
        '6B54EF7BE1F24B4AE06C2E102FDDECE3',
        '96BDD6CAA15045EE1D76C9F0D78C96F8',
        'A6E78D8E24B8E353052E2249D6F9AEAB',
        'EE31C0E37F7D53D7BAA70A77A021689F',
        'EB7E3AE010990D9D090E03CCD2314084',
        '53D774BBBABCA395171EAEE8D55EAC5B',
        '162780E37E7A9FBB2A74C13E1FDEF762',
        '307D78D0FCC372876C5D8B5555C9BE0A',
        '7E23FDD721429B45ECBAD6496D2DAE59',
        '94FBAB09356FB40ED84A76C2992540A1',
        '811BA58E88DCCCD45EEFD8A5267EF452',
        '6BA1EBAD82628C1A0CD5E37720FF2D7B',
        'A2FF05266E66A5F4A20AACCE01F496A5',
        '614557FE592816E499C14E7CAD26924A',
        'E749D8A8A8C0EB219B5A9FDBEB119E49',
        'E749D8A8A8C0EB219B5A9FDBEB119E49',
        'AD478E2EE5154B8492C9F316ECBCF739',
        'DCD6630C7ECA6CB75BC4C166F419AF68',
        '6421CA58376A9A437ABD7D579EA4A5A2',
        'F4ADA68E160A499B9652B7ED09439CF6',
        'C5E8CA4845EB66E9C2950221372E4860',
        '1DF91CDE9CED88DFA76117C618C94764',
        '523C4645AE7F3FFDC0C54C68142155DB',
        '9046C8341165034AFCE84430BBD1C47C',
        '52AE4651029D65B60ABB0EB742BE1816',
        '4780201811028D33B8ADE4F0CC225622',
        '872F3D91184B9B898AF7C9A09DCA0C5C',
        '872F3D91184B9B898AF7C9A09DCA0C5C',
        '79FAB8495FA23C0957EAD7B3AB1D7997',
        '56FE93733E48BCDF5DA2F207FAAD469C',
        'D860E0FB763718412F9490083F894194',
        '998A88E814426978EF29D39BC437DED3',
        'C0A13ECC30E2F7AEC7E4D3DAF93FD29D',
        'C0A13ECC30E2F7AEC7E4D3DAF93FD29D',
        '924830DA7EF55DA4FD2049CEE13EA496',
        '425534DA3C7D05E8F48A021A44F54F65',
        '1844AD1778C6DEAC047DC3FA30FDA369',
        'FF35EBA5192F4B70B51A96E71123C8ED',
        '869143E31EA6F48EA19DB3E19043262D',
        '20CDB4019769362EE605B52CC63E491D',
        'E2828D5F5688823C6FFFBD9C8AE82479',
        '2A6990771998E69EC92B03071EC4B221',
        'A599C0DDC67F3D4253563FFD7673180D',
        'FE2F3A031D5DC85D4175F25E5ED24A4A',
        '902E39CAF60B20BC666820ABC395369F',
        '8936D6EAE8CFC6C1EC65750947DF1DCA',
        'A787FAF2DF8129F4CE9C900E0EAAF1E2',
        'A787FAF2DF8129F4CE9C900E0EAAF1E2',
        '7C78F540F586C6B00975B71E26B57577',
        '659C24E637B8D1E20C9B604049D61369',
        '2D0121836470B70A102D24DE3D67F9B2',
        '52E99349624C999FD7D1C8E7012DB9CC',
        '4ADC5763893D08A9B2CD651ABCED1F77',
        'A7CCF842D8CF29D95A07EF68A3E634FA',
        '4DABEFB1941008102A10D1EE01E84B89',
        '55700F00196A25FCD464D3D13BE2D1DC',
        'BC130D0DAAFCCB0841D069B99A50EA4B',
        '12239B9382B93D3469CBC564FD0BB09D',
        '0AD95A0E1D8D3FF83A9D0B29CC09927E',
        '60BA153B0CD471DB98849E99E6F59764',
        '535026337ACDA223174D8BF0BD27BE0F',
        '333450DFE2CE3921818799DD3163EFDA',
        '48C616ED52447AE53D1EC9B11A54AB08',
        'C8F8F63B37AA6C9512C0F14F1995DEC1',
        '362692C4CED8072AF950CB4E2F4B5912',
        '4BD0B6C6435A4C9D2823E76793180503',
        '9F6F7D4D76016C7E74B1693ADAFE777D',
        '4A82F96EE10B3098B1FD686D1A6D83EA',
        '03387C69995E470B502FFC4979F2CED5',
        'E5A600FDDE9CE35E3573B41071850CC8',
        '049EB33612F2E7D4A8D469ED4236513A',
        'BCD7CE62CADA6796D2CBC77005EAB51D',
        '435E0F24C8D20CAF6EA6930406A0E305',
        '2BC6FB60ACD1BB7AC225FB3CA6BE5D81',
        'C0C5BCB15C2710D65B88811BA3F17332',
        '495CB0876FC3A3677F224F1AFDEF7223',
        '7E42EFA6914CF959A698A6CF2D62850E',
        '50269A39E817B5EFCB41F3E420EF1F28',
        'E58EC3EEA2E32AB17C4FD81B3A7CE8FD',
        '524EA300A58DFA69A707B54EEC9A1ABE',
        '15B75C9A6E8124C7D25727632F4D97A6',
        '09D779BF3605B46A7C05844CA05FC870',
        '69FB8B573F16014FCA324526029DEB58',
        '9AF19608BDB58B82EC49BA7B7E4B6AA7',
        'DCB03985194E5964BF0E21634A99315F',
        '79D004968400810E10517D0E00C4BA35',
        'BC714B60DE4CCD3ECC9FEEB4A0DC161D',
        '76FCF8DEAE2F269C472DE93B974A53FF',
        '73E4DF5EB994B8E7B76873865B2EFE11',
        'DA4F31EE29815DF5FB44D8A6A86D8D08',
        '327CE6765E8CAA2E20B3F9FC20BE2434',
        '4804034B1625E5C26E5237FA8E445CD2',
        'FA2BF5FCA85E10D261598EA4E08472E0',
        '4FAF52D79F359F9D75A96EC96D5C82F7',
        '13BA34AF957A1DDEE179D04CFDF05F60',
        '8DA1F905EB485DC59DED04840C04B40F',
        '094647A0A71E2A6DF5A2180162B0B97C',
        '7EF2C27BA1DFF47C1AAA8698D5E4D007',
        'DA8E01901BCB449C938C42EE436D89EA',
        '39677CE4187CF1C80934A0A4D83D4681',
        '2BBAC99D135C955D5DC27B608DB45A38',
        '6324322FD38A93FD050E93B3A12B2488',
        '90C7DBBA3E6E46FA66CC8C64F322B2DF',
        '74E67C4AD429317A51AF69D7F983ACAE',
        '74E67C4AD429317A51AF69D7F983ACAE',
        'FF36766B97304CA7DA8E74F38D3EE9B3',
        'B02B90E65572789AD7EF9F12375CD765',
        'EA6D61F306ABFD0541845BFE2D451CB9',
        '9D5206467032C1EE96BEC93DF854A506',
        '7C04B23884BB861566712F73828CD2D0',
        '07ED260734F7B55527D2F769621B6359',
        'F0FE207138A22BBD0945D5AD34FE8881',
        'ABB2893182A5B8D2329FC7E82E813B0C',
        '9984FE0969E1053CFC2DB737D62A23BA',
        '978461672C2CD5A5A5DBB721AF4D6791',
        '7CAF6A3DF76AC196C10DB3B9D37D30D7',
        '42436382568435516B6340526D4EEBAA',
        '7DBE38CB039BEE1CAD82F3D1ECCA2F43',
        '0A8F44266EABD458C238F90BDD428BFB',
        '56F70B5C9A001A69FD2EFB9F52395B5D',
        '56F70B5C9A001A69FD2EFB9F52395B5D',
        'AC5064F5D44D105879BDB1DC144A697B',
        'F6278F414CC6B7F27FDE20C938B22DE7',
        '0D1E8AC6AC59AEEAF34BBFF6C3150D6D',
        '3819DAAAEB9CEC5AEB231BD85F05A36E',
        '20A1DFDDDC2EF93ACC809E821F087894',
        '20A1DFDDDC2EF93ACC809E821F087894',
        '7459850989D69FBD9BE4254591A74E66',
        'FECB2A40CA14E4823B3F109226BA301E',
        '247899F4F5D48D915AE35913A00E8657',
        'EAF1B83C561A97555FC0CDE38891A389',
        '79AE5478465A9FEB537AFCCA01F560D8',
        '2FBCCBA7B754792DFC2070456E66FBD7',
        'FEFD69E2A0F256F888409A157FAE2532',
        'AFF0F5E372BD49CEB9F615B9A04C97DF',
        '8D2420C8100D78D05BCF2F181DF62056',
        '95A394BDC738A4C5CB5D4F7D7E17E41C',
        'FA70FCDF79FE20CD7938D717EA5C428A',
        'A2BAA01CCDEA3190E4998A54DBC202A4',
        '321A559E4CA9B67093E4D1EBA3F7C35F',
        '216372BFC20F8F32318EF19B09CD2E16'
    ]

    scan_md5_hashes(md5_hashes)